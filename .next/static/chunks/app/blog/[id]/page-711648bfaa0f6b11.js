(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[567],{4248:(e,t,r)=>{Promise.resolve().then(r.bind(r,9410))},4995:(e,t,r)=>{"use strict";r.d(t,{nc:()=>l});var s=r(5453),a=r(6786);let l=(0,s.v)()((0,a.Zr)(e=>({user:null,token:null,isAuthenticated:!1,setUser:t=>e({user:t,isAuthenticated:!!t}),setToken:t=>e({token:t}),logout:()=>e({user:null,token:null,isAuthenticated:!1})}),{name:"auth-storage",storage:(0,a.KU)(()=>localStorage)}))},9410:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var s=r(5155),a=r(2115),l=r(1154),i=r(7550),o=r(9917),n=r(2525),c=r(6683),d=r(5695),m=r(6671),u=r(4995),x=r(822),h=r(8042);function p(e){var t;let{postId:r,initialData:p,error:g}=e,[f,b]=(0,a.useState)(p||null),{user:y,token:j}=(0,u.nc)(),[N,v]=(0,a.useState)(!1),[w,k]=(0,a.useState)(!p&&!g),[E,S]=(0,a.useState)(g||null),[A,_]=(0,a.useState)(!1),z=(0,d.useRouter)();(0,a.useEffect)(()=>{y&&f?v(String(y.id)===String(f.author_id)):v(!1)},[y,f]),(0,a.useEffect)(()=>{p||(async()=>{try{k(!0);let e=await fetch("https://admin-api.pay.importa.biz/api/posts/".concat(r));if(!e.ok)throw Error("Failed to fetch post");let t=await e.json();200===t.status&&t.data?b(t.data):S("Post not found")}catch(e){S("Error loading post. Please try again later."),console.error("Error fetching post:",e)}finally{k(!1)}})()},[r,p]);let C=async()=>{if(navigator.share)try{await navigator.share({title:null==f?void 0:f.title,text:null==f?void 0:f.subtitle,url:window.location.href})}catch(e){m.oR.error("Failed to share the post")}else navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")};if(w)return(0,s.jsxs)("div",{className:"min-h-screen flex justify-center items-center",children:[(0,s.jsx)(l.A,{className:"w-8 h-8 animate-spin text-purple-600"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading post..."})]});if(E||!f)return(0,s.jsxs)("div",{className:"min-h-screen flex flex-col justify-center items-center p-8",children:[(0,s.jsx)("p",{className:"text-red-500 mb-4",children:E||"Post not found"}),(0,s.jsx)("button",{onClick:()=>z.push("/blog"),className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Back to Blog"})]});let L=async()=>{try{if(!f)return void m.oR.error("Post data is not available");let e={id:f.id,title:f.title,subtitle:f.subtitle||"",content:f.content,category_id:f.category_id,image:f.image||"",is_published:f.is_published,isDraft:!1,categories:f.categories?{id:f.categories.id,name:f.categories.name}:null};sessionStorage.setItem("editingPost",JSON.stringify(e)),z.push("/dashboard/upload/fileUpload"),m.oR.loading("Loading editor...")}catch(e){console.error("Error preparing edit mode:",e),m.oR.error("Failed to prepare edit mode. Please try again.")}},P=async()=>{if(confirm("Are you sure you want to delete this post?"))try{_(!0);let e=localStorage.getItem("token"),t=await fetch("https://admin-api.pay.importa.biz/api/posts/".concat(r),{method:"DELETE",headers:{accept:"*/*",Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok)m.oR.success("Post deleted successfully"),z.push("/blog");else{let e=await t.json().catch(()=>({}));throw Error(e.message||"Failed to delete post")}}catch(t){console.error("Error deleting post:",t);let e=t instanceof Error?t.message:"Failed to delete post";m.oR.error(e)}finally{_(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,s.jsx)(m.l$,{position:"top-right"}),(0,s.jsx)("div",{className:"max-w-3xl mx-auto px-4 pt-8",children:(0,s.jsxs)("button",{onClick:()=>z.push("/blog"),className:"inline-flex transform cursor-pointer items-center text-gray-600 hover:text-purple-600 transition-colors",children:[(0,s.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Back to Blog"]})}),(0,s.jsxs)("div",{className:"max-w-3xl mx-auto px-4 py-12",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-2 leading-tight text-gray-900",children:f.title}),f.subtitle&&(0,s.jsx)("p",{className:"text-xl text-gray-600 mb-6",children:f.subtitle}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8 flex-wrap gap-4",children:[(0,s.jsxs)("div",{className:"flex space-x-3 items-center",children:[(0,s.jsx)("span",{className:"bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-medium",children:(null==(t=f.categories)?void 0:t.name)||"Uncategorized"}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:new Date(f.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}),(0,s.jsxs)("span",{className:"text-sm text-gray-400",children:["• ",Math.ceil(f.content.split(/\s+/).length/200)," min read"]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[N&&j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:L,className:"border border-blue-300 px-4 py-1.5 rounded-xl flex items-center space-x-2 cursor-pointer hover:bg-blue-50 transition-colors",children:[(0,s.jsx)("span",{className:"text-sm",children:"Edit"}),(0,s.jsx)(o.A,{className:"w-4 h-4"})]}),(0,s.jsxs)("button",{onClick:P,disabled:A,className:"border border-red-300 px-4 py-1.5 rounded-xl flex items-center space-x-2 cursor-pointer hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("span",{className:"text-sm",children:"Delete"}),(0,s.jsx)(n.A,{className:"w-4 h-4"})]})]}),(0,s.jsxs)("button",{onClick:C,className:"border border-gray-300 px-4 py-1.5 rounded-xl flex items-center space-x-2 cursor-pointer hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("span",{className:"text-sm",children:"Share"}),(0,s.jsx)(c.A,{className:"w-4 h-4"})]})]})]}),(0,s.jsx)("div",{className:"w-full h-96 bg-gray-100 rounded-lg mb-8 overflow-hidden",children:f.image?(0,s.jsx)("img",{src:f.image,alt:f.title,className:"w-full h-full object-cover",onError:e=>{let t=e.target;t.onerror=null,t.src="https://via.placeholder.com/800x400?text=Image+Not+Available"}}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,s.jsx)("article",{className:"max-w-3xl mx-auto font-serif",children:function(e){let t=x.A.sanitize(e||"",{ADD_ATTR:["target","rel","class"]}),r={replace:e=>{var t;if(!e||"object"!=typeof e||!("type"in e))return;if("text"===e.type)return e.data;if("tag"!==e.type)return;let{name:a,children:l=[],attribs:i={}}=e,o=()=>(0,h.zd)(l,r);if("h1"===a)return(0,s.jsx)("h1",{className:"text-4xl md:text-5xl font-serif font-bold leading-tight mt-8 mb-4 text-gray-900",children:o()});if("h2"===a)return(0,s.jsx)("h2",{className:"text-2xl md:text-3xl font-serif font-semibold leading-snug mt-6 mb-3 text-gray-900",children:o()});if("h3"===a)return(0,s.jsx)("h3",{className:"text-xl font-semibold mt-6 mb-2 text-gray-900",children:o()});if("p"===a)return(0,s.jsx)("p",{className:"text-lg leading-[1.65] text-gray-700 mt-4 mb-4",children:o()});if("ul"===a)return(0,s.jsx)("ul",{className:"list-disc ml-6 space-y-2 mt-4",children:o()});if("ol"===a)return(0,s.jsx)("ol",{className:"list-decimal ml-6 space-y-2 mt-4",children:o()});if("li"===a)return 1===l.length&&"type"in l[0]&&"tag"===l[0].type&&"name"in l[0]&&"p"===l[0].name&&"children"in l[0]?(0,s.jsx)("li",{className:"ml-0",children:(0,h.zd)(l[0].children,r)},e.attribs.key||Math.random().toString(36).substr(2,9)):(0,s.jsx)("li",{className:"ml-0",children:(0,h.zd)(l,r)},e.attribs.key||Math.random().toString(36).substr(2,9));if("img"===a){let e=i.src||i["data-src"]||"";return e?(0,s.jsx)("img",{src:e,alt:i.alt||"",loading:"lazy",className:"".concat(i.class||""," rounded-lg w-full h-auto my-6")}):null}if("mark"===a||"span"===a&&(null==(t=i.class)?void 0:t.includes("highlight")))return(0,s.jsx)("mark",{className:"bg-yellow-200 px-1 rounded",children:o()});if("a"===a){let e=i.href||"#",t=e&&/^(https?:)?\/\//.test(e)&&!e.startsWith(window.location.origin);return(0,s.jsx)("a",{href:e,target:t?"_blank":i.target||void 0,rel:t?"noopener noreferrer":i.rel||void 0,className:"underline text-purple-600 hover:text-purple-800",children:o()})}return"blockquote"===a?(0,s.jsx)("blockquote",{className:"border-l-4 border-gray-300 pl-4 italic text-gray-700 my-6",children:o()}):"code"===a?(0,s.jsx)("code",{className:"bg-gray-100 px-1 py-[2px] rounded text-sm font-mono",children:o()}):"pre"===a?(0,s.jsx)("pre",{className:"bg-gray-900 text-gray-100 p-4 rounded overflow-x-auto my-6",children:o()}):void 0}};return(0,h.Ay)(t,r)}(f.content)}),0===f.is_published&&(0,s.jsx)("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-yellow-800 text-sm",children:"⚠️ This post is currently unpublished"})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9,753,408,441,684,358],()=>t(4248)),_N_E=e.O()}]);